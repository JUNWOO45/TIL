# 0512

## CORS

### 출처(Origin)란?

출처란 `Protocol` , `Host`, 그리고 `포트번호` 까지를 의미한다.

```
https://junwoo45.github.io
```



- CORS는 브라우저의 구현 스펙에 포함되는 정책이다.
  - 따라서 브라우저를 통하지 않고 서버 간 통신을 할 때는 이 정책이 적용되지 않는다.
  - 만약 CORS 정책을 위반하는 리소스 요청을 하더라도, 서버는 정상적으로 응답을 하게되고, 브라우저가 이 리스폰스를 분석해 CORS 정책 위반이라도 판단하여 리스폰스를 버리게 된다.
  - 서버 쪽 로그에는 정상적으로 응답했다는 로그만 남아있기때문에, 원인을 모른다면 곤란해질 수 있다.



### CORS의 동작방식

- 리소스를 요청할 때는 HTTP 프로토콜을 사용하여 요청을 보내게된다.
  이 때, 브라우저는 Request Header에 `Origin` 이라는 필드에 요청을 보내는 출처를 함께 담아 보낸다.
- 이후 서버가 리스폰스를 내려줄 때, Response Header의 `Access-Control-Allow-Origin` 이라는 값에 "이 리소스를 접근하는 것이 허용된 출처"를 내려주고,
  리스폰스를 받은 브라우저는 자신이 보냈던 리퀘스트의 `Origin` 과 서버로부터 내려받은 리스폰스의 `Access-Control-Allow-Origin` 을 비교하여 유효성을 검증한다.

### CORS를 해결하는 방법

- Access-Control-Allow-Origin 세팅하기
  - 서버에서 세팅하는 방법이다.
  - 와일드카드 `*` 를 사용하면 편할 수있지만 보안상 이슈가 있다.
  - Nginx나 Apache와 같은 서버엔진의 설정에서 추가할 수 있지만, 복잡할 수 있기때문에 응답 미들웨어 등에서 세팅한다고 한다.
- Webpack Dev Server로 리버스 프록싱하기
  - 프론트의 개발환경을 위해 백엔드에서 `http://localhost:3000` 같은 출처를 넣어주진 않기때문에, 프론트엔드 개발자들은 주로 `webpack-dev-server` 의 프록시기능을 사용하여 CORS정책을 우회할 수 있다.
  - 